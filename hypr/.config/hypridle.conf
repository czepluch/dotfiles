# Hypridle Configuration
# Manages idle timeouts and automatic suspension

general {
    # Command to run before sleep (lock the screen for security)
    before_sleep_cmd = loginctl lock-session

    # Command to run after waking from sleep
    after_sleep_cmd = hyprctl dispatch dpms on

    # Lock command - prevents multiple hyprlock instances
    lock_cmd = pidof hyprlock || hyprlock

    # Unlock command (optional, for any cleanup after unlock)
    # unlock_cmd = notify-send "Unlocked"

    # Ignore dbus-inhibit - set to false to respect app inhibitors
    # This allows apps like video players to prevent suspension
    ignore_dbus_inhibit = false

    # Ignore systemd-inhibit - set to false to respect system inhibitors
    ignore_systemd_inhibit = false
}

# ===== TIMEOUT SETTINGS =====
# These values are in seconds. Adjust as needed:
# 300 seconds = 5 minutes
# 420 seconds = 7 minutes
# 600 seconds = 10 minutes
# 900 seconds = 15 minutes
# 1800 seconds = 30 minutes
#
# Note: Currently these timeouts apply regardless of power state (AC/battery).
# To implement different timeouts based on power state, you would need a
# custom script that detects AC state and adjusts behavior accordingly.

# Listener 1: Lock the screen
# Timeout: 5 minutes (300 seconds)
listener {
    timeout = 300
    on-timeout = loginctl lock-session
    # on-resume is called when activity is detected after idle
}

# Listener 2: Turn off displays
# Timeout: 7 minutes (420 seconds)
# This saves power while keeping the system running
listener {
    timeout = 420
    on-timeout = hyprctl dispatch dpms off
    on-resume = hyprctl dispatch dpms on
}

# Listener 3: Suspend the system
# Timeout: 30 minutes (600 seconds)
# The system will go to sleep after this period of inactivity
listener {
    timeout = 1800
    on-timeout = systemctl suspend
    # on-resume not needed here as system wakes up via hardware event
}

# ===== INHIBITOR BEHAVIOR =====
# With ignore_dbus_inhibit = false and ignore_systemd_inhibit = false:
# - Fullscreen applications will prevent idle
# - Video players (via MPRIS) will prevent idle
# - Audio playback will prevent idle
# - Applications can use systemd-inhibit to block suspension
# - Games and presentation software typically set inhibitors
#
# Common inhibitor sources:
# - Firefox/Chrome when playing video
# - VLC, mpv, and other media players
# - Games running in fullscreen
# - Presentation mode in various apps
#
# You can check active inhibitors with:
#   systemd-inhibit --list
